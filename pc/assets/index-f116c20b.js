import{x as h,J as B,K as w,_ as I,L as T}from"./index-35648525.js";import{h as S,af as V,r as F,j as f,o as s,k as l,m as i,T as r,z as u,ag as L,Y as g,Z as y,U as $,a4 as k,l as j,_ as z,$ as N,p as R,ah as D}from"./vue-18a0f25a.js";const x=o=>(z("data-v-a7a098aa"),o=o(),N(),o),E=["id"],U={key:0,class:"loading"},Y={key:1,class:"captcha-img-box"},J=["src","alt"],K=["onClick"],M={key:2,class:"captcha-prompt"},P={key:3,class:"captcha-prompt"},X={class:"captcha-refresh-box"},Z=x(()=>i("div",{class:"captcha-refresh-line captcha-refresh-line-l"},null,-1)),q=["title"],A=x(()=>i("div",{class:"captcha-refresh-line captcha-refresh-line-r"},null,-1)),G=S({__name:"index",props:{uuid:{default:""},callback:{type:Function,default:()=>{}},class:{default:""},unset:{type:Boolean,default:!1},error:{default:h.global.t("validate.The correct area is not clicked, please try again!")},success:{default:h.global.t("validate.Verification is successful!")}},setup(o){const e=o;V(t=>({"0aacbc72":C.value,"52eceb8a":v.value,"314b8f1b":a.captcha.width,"43514b1c":a.captcha.height}));const a=F({loading:!0,xy:[],tip:"",captcha:{id:"",text:"",base64:"",width:350,height:200}}),n=()=>{a.loading=!0,B(e.uuid).then(t=>{a.xy=[],a.tip="",a.loading=!1,a.captcha=t.data})},m=t=>{if(a.xy.length<a.captcha.text.length&&(a.xy.push(t.offsetX+","+t.offsetY),a.xy.length==a.captcha.text.length)){const p=[a.xy.join("-"),t.target.width,t.target.height].join(";");w(e.uuid,p,e.unset).then(()=>{a.tip=e.success,setTimeout(()=>{var c;(c=e.callback)==null||c.call(e,p),_()},1500)}).catch(()=>{a.tip=e.error,setTimeout(()=>{n()},1500)})}},b=t=>{a.xy.splice(t,1)},_=()=>{var t;(t=document.getElementById(e.uuid))==null||t.remove()},v=f(()=>(a.captcha.height+200)/2+"px"),C=f(()=>(a.captcha.width+24)/2+"px");return n(),(t,p)=>(s(),l("div",{id:t.uuid},[i("div",{class:k(["ba-click-captcha",e.class])},[a.loading?(s(),l("div",U,r(u(h).global.t("utils.Loading")),1)):(s(),l("div",Y,[i("img",{class:"captcha-img",onClick:p[0]||(p[0]=L(c=>m(c),["prevent"])),src:a.captcha.base64,alt:u(h).global.t("validate.Captcha loading failed, please click refresh button")},null,8,J),(s(!0),l(g,null,y(a.xy,(c,d)=>(s(),l("span",{key:d,class:"step",onClick:O=>b(d),style:j(`left:${parseFloat(c.split(",")[0])-13}px;top:${parseFloat(c.split(",")[1])-13}px`)},r(d+1),13,K))),128))])),a.tip?(s(),l("div",M,r(a.tip),1)):(s(),l("div",P,[$(r(u(h).global.t("validate.Please click"))+" ",1),(s(!0),l(g,null,y(a.captcha.text,(c,d)=>(s(),l("span",{key:d,class:k(a.xy.length>d?"clicaptcha-clicked":"")},r(c),3))),128))])),i("div",X,[Z,i("i",{class:"fa fa-refresh captcha-refresh-btn",title:u(h).global.t("Refresh"),onClick:n},null,8,q),A])],2),i("div",{class:"ba-layout-shade",onClick:_})],8,E))}});const H=I(G,[["__scopeId","data-v-a7a098aa"]]),aa=(o,e,a={})=>{let n=R(H,{uuid:o,callback:e,...a,key:T()});D(n,document.body),n=null};export{aa as c};
